<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>

    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <title>Readme for SHA1 Encryption</title>
  </head>
  <body>
    <meta charset="utf-8">
    <meta charset="utf-8">
    <div style="color: black; font-style: normal;
      font-variant-ligatures: normal; font-variant-caps: normal;
      font-weight: normal; letter-spacing: normal; line-height: normal;
      orphans: 2; text-align: start; text-indent: 0px; text-transform:
      none; white-space: normal; widows: 2; word-spacing: 0px;
      -webkit-text-stroke-width: 0px; font-size: medium; font-family:
      &quot;times new roman&quot;, times, serif;">
      <div align="center"><big><big><u><b>How to encrypt WebNMS
                passwords with SHA-1 encryption<br>
                <br>
              </b></u></big></big></div>
      The latest hotfix PPM (greater than 15th PPM) of WebNMS supports sha-1 encryption of
      passwords. Here are the enhancements:<br>
      <br>
      <b>1.<span class="Apple-converted-space">&nbsp;</span></b>Encrypts
      user passwords in SHA-1 mode which are not decryptable<br>
      <b>2.&nbsp;</b>Encrypts other passwords (the ones which are
      encrypted using bin/admintools/EncryptPassword script) using&nbsp;<b>AES
        encryption technique</b></div>
    <div style="color: black; font-style: normal;
      font-variant-ligatures: normal; font-variant-caps: normal;
      font-weight: normal; letter-spacing: normal; line-height: normal;
      orphans: 2; text-align: start; text-indent: 0px; text-transform:
      none; white-space: normal; widows: 2; word-spacing: 0px;
      -webkit-text-stroke-width: 0px; font-size: medium; font-family:
      &quot;times new roman&quot;, times, serif;"><br>
      Please follow the below steps:<br>
      <br>
    </div>
    <div style="color: black; font-style: normal;
      font-variant-ligatures: normal; font-variant-caps: normal;
      font-weight: normal; letter-spacing: normal; line-height: normal;
      orphans: 2; text-align: start; text-indent: 0px; text-transform:
      none; white-space: normal; widows: 2; word-spacing: 0px;
      -webkit-text-stroke-width: 0px; font-size: medium; font-family:
      &quot;times new roman&quot;, times, serif;">1. Download &amp; copy
      <a
href="https://github.com/ramanan99/TestSnippets/blob/master/sha1_encryption/GetEncryptedPasswords.java">GetEncryptedPasswords.java</a>
      under NMS_HOME\temp</div>
    <div style="color: black; font-style: normal;
      font-variant-ligatures: normal; font-variant-caps: normal;
      font-weight: normal; letter-spacing: normal; line-height: normal;
      orphans: 2; text-align: start; text-indent: 0px; text-transform:
      none; white-space: normal; widows: 2; word-spacing: 0px;
      -webkit-text-stroke-width: 0px; font-size: medium; font-family:
      &quot;times new roman&quot;, times, serif;"><br>
    </div>
    <div style="color: black; font-style: normal;
      font-variant-ligatures: normal; font-variant-caps: normal;
      font-weight: normal; letter-spacing: normal; line-height: normal;
      orphans: 2; text-align: start; text-indent: 0px; text-transform:
      none; white-space: normal; widows: 2; word-spacing: 0px;
      -webkit-text-stroke-width: 0px; font-size: medium; font-family:
      &quot;times new roman&quot;, times, serif;">2. Set the CLASSPATH
      as follows:</div>
    <div style="color: black; font-style: normal;
      font-variant-ligatures: normal; font-variant-caps: normal;
      font-weight: normal; letter-spacing: normal; line-height: normal;
      orphans: 2; text-align: start; text-indent: 0px; text-transform:
      none; white-space: normal; widows: 2; word-spacing: 0px;
      -webkit-text-stroke-width: 0px; font-size: 13px; font-family:
      Arial, Helvetica, sans-serif;"><font face="courier new, courier,
        monospace" color="#0000ff" size="2">set CLASSPATH=<b>%NMS_HOME%\temp</b>;%NMS_CLASSES%\NmsServerClasses.jar;%NMS_CLASSES%\hbnlib;%NMS_CLASSES%\AdventNetNPrevalent.jar;%NMS_CLASSES%\AdventNetSnmp.jar;%NMS_CLASSES%\hbnlib\hibernate3.jar;%NMS_CLASSES%\hbnlib\dom4j-1.6.1.jar;%NMS_CLASSES%\hbnlib\commons-logging-1.0.4.jar;%NMS_HOME%\mysql\driver\mysql_connector.jar</font></div>
    <div style="color: black; font-style: normal;
      font-variant-ligatures: normal; font-variant-caps: normal;
      font-weight: normal; letter-spacing: normal; line-height: normal;
      orphans: 2; text-align: start; text-indent: 0px; text-transform:
      none; white-space: normal; widows: 2; word-spacing: 0px;
      -webkit-text-stroke-width: 0px; font-size: medium; font-family:
      &quot;times new roman&quot;, times, serif;"><br>
    </div>
    <div style="color: black; font-style: normal;
      font-variant-ligatures: normal; font-variant-caps: normal;
      font-weight: normal; letter-spacing: normal; line-height: normal;
      orphans: 2; text-align: start; text-indent: 0px; text-transform:
      none; white-space: normal; widows: 2; word-spacing: 0px;
      -webkit-text-stroke-width: 0px; font-size: medium; font-family:
      &quot;times new roman&quot;, times, serif;">3. Copy <b>%NMS_CLASSES%\hbnlib\hibernate.cfg.xml</b>
      under NMS_HOME\temp<br>
      <br>
      4. Execute&nbsp;<span style="color: rgb(0, 0, 255); font-family:
        &quot;courier new&quot;, courier, monospace; font-size: small;"><b>java
          test.GetEncryptedPasswords</b></span>&nbsp;- It will parse
      the&nbsp;<b><i>UserPasswordTable</i></b>&nbsp;in your database
      (configured in <b>hibernate.cfg.xml</b>) and will give an output
      as follows:<br>
      <br>
    </div>
    <div style="color: black; font-style: normal;
      font-variant-ligatures: normal; font-variant-caps: normal;
      font-weight: normal; letter-spacing: normal; line-height: normal;
      orphans: 2; text-align: start; text-indent: 0px; text-transform:
      none; white-space: normal; widows: 2; word-spacing: 0px;
      -webkit-text-stroke-width: 0px; font-size: 13px; font-family:
      Arial, Helvetica, sans-serif;"><font face="courier new, courier,
        monospace" color="#0000ff" size="2">userName&nbsp;<span style="white-space: pre;">	</span>oldPassword&nbsp;<span style="white-space: pre;">	</span>plainTextPassword&nbsp;<span style="white-space: pre;">	</span>newEncryptedPassword</font></div>
    <div style="color: black; font-style: normal;
      font-variant-ligatures: normal; font-variant-caps: normal;
      font-weight: normal; letter-spacing: normal; line-height: normal;
      orphans: 2; text-align: start; text-indent: 0px; text-transform:
      none; white-space: normal; widows: 2; word-spacing: 0px;
      -webkit-text-stroke-width: 0px; font-size: 13px; font-family:
      Arial, Helvetica, sans-serif;"><font face="courier new, courier,
        monospace" color="#0000ff" size="2">=================================================================</font></div>
    <div style="color: black; font-style: normal;
      font-variant-ligatures: normal; font-variant-caps: normal;
      font-weight: normal; letter-spacing: normal; line-height: normal;
      orphans: 2; text-align: start; text-indent: 0px; text-transform:
      none; white-space: normal; widows: 2; word-spacing: 0px;
      -webkit-text-stroke-width: 0px; font-size: 13px; font-family:
      Arial, Helvetica, sans-serif;"><font face="courier new, courier,
        monospace" color="#0000ff" size="2">guest&nbsp;<span style="white-space: pre;">	</span>e8c89O1f&nbsp;<span style="white-space: pre;">	</span>guest&nbsp;<span style="white-space: pre;">&nbsp; </span><b
          style="background-color: rgb(254, 255, 51);">R6fQQVHUX9v28aP0Lg19cWWlHaM1IsiJ52Dof1QTb5E=</b></font></div>
    <div style="color: black; font-style: normal;
      font-variant-ligatures: normal; font-variant-caps: normal;
      font-weight: normal; letter-spacing: normal; line-height: normal;
      orphans: 2; text-align: start; text-indent: 0px; text-transform:
      none; white-space: normal; widows: 2; word-spacing: 0px;
      -webkit-text-stroke-width: 0px; font-size: 13px; font-family:
      Arial, Helvetica, sans-serif;"><font face="courier new, courier,
        monospace" color="#0000ff" size="2">root&nbsp;<span style="white-space: pre;">	</span>b96u1ae9J&nbsp;<span style="white-space: pre;">	</span>public&nbsp;<span style="white-space: pre;"> </span><b
          style="background-color: rgb(254, 255, 51);">PUvCeQbqr3hYbagHlhn7+HeiBRIiAaaZjQA7jBP4yik=</b></font></div>
    <div style="color: black; font-style: normal;
      font-variant-ligatures: normal; font-variant-caps: normal;
      font-weight: normal; letter-spacing: normal; line-height: normal;
      orphans: 2; text-align: start; text-indent: 0px; text-transform:
      none; white-space: normal; widows: 2; word-spacing: 0px;
      -webkit-text-stroke-width: 0px; font-size: medium; font-family:
      &quot;times new roman&quot;, times, serif;"><br>
    </div>
    <div style="color: black; font-style: normal;
      font-variant-ligatures: normal; font-variant-caps: normal;
      font-weight: normal; letter-spacing: normal; line-height: normal;
      orphans: 2; text-align: start; text-indent: 0px; text-transform:
      none; white-space: normal; widows: 2; word-spacing: 0px;
      -webkit-text-stroke-width: 0px; font-size: medium; font-family:
      &quot;times new roman&quot;, times, serif;">5. Note down these
      passwords (last column) and open the securitydbData.xml and
      replace the old passwords with the new values (<a
href="https://github.com/ramanan99/TestSnippets/blob/master/sha1_encryption/securitydbData.xml##L4-L5">Refer
        this securitydbData.xml file</a> as what will change)<br>
      <br>
    </div>
    <div style="color: black; font-style: normal;
      font-variant-ligatures: normal; font-variant-caps: normal;
      font-weight: normal; letter-spacing: normal; line-height: normal;
      orphans: 2; text-align: start; text-indent: 0px; text-transform:
      none; white-space: normal; widows: 2; word-spacing: 0px;
      -webkit-text-stroke-width: 0px; font-size: 13px; font-family:
      Arial, Helvetica, sans-serif;"><span style="font-family:
        &quot;times new roman&quot;, times, serif; font-size: medium;">(If
        you had set&nbsp;<a
href="http://www.webnms.com/webnms/help/developer_guide/security_services/startup_options/security_fe.html#NMSAuthManager"><b>persist_data_in_xml</b></a>&nbsp;as
        false, then you need to alter the&nbsp;<b>UserPasswordTable</b>&nbsp;-&nbsp;</span><font
        face="courier new, courier, monospace" color="#0000ff" size="2">alter
        UserPasswordTable set PASSWORD='</font><font face="courier new,
        courier, monospace" color="#0000ff" size="2"><span style="white-space: pre;"></span><b
          style="background-color: rgb(254, 255, 51);">PUvCeQbqr3hYbagHlhn7+HeiBRIiAaaZjQA7jBP4yik=</b></font><font
        style="font-family: &quot;times new roman&quot;, times, serif;"
        size="3"><font face="courier new, courier, monospace"
          color="#0000ff" size="2">' where USERNAME like '<b>root</b>'</font>)</font></div>
    <div style="color: black; font-style: normal;
      font-variant-ligatures: normal; font-variant-caps: normal;
      font-weight: normal; letter-spacing: normal; line-height: normal;
      orphans: 2; text-align: start; text-indent: 0px; text-transform:
      none; white-space: normal; widows: 2; word-spacing: 0px;
      -webkit-text-stroke-width: 0px; font-size: medium; font-family:
      &quot;times new roman&quot;, times, serif;"><br>
    </div>
    <div style="color: black; font-style: normal;
      font-variant-ligatures: normal; font-variant-caps: normal;
      font-weight: normal; letter-spacing: normal; line-height: normal;
      orphans: 2; text-align: start; text-indent: 0px; text-transform:
      none; white-space: normal; widows: 2; word-spacing: 0px;
      -webkit-text-stroke-width: 0px; font-size: medium; font-family:
      &quot;times new roman&quot;, times, serif;">6. Update the WebNMS
      scripts as follows:<br>
      <table style="width: 1324px;" border="1" cellpadding="2"
        cellspacing="2">
        <tbody>
          <tr>
            <td>Files</td>
            <td>Changes</td>
          </tr>
          <tr>
            <td>
              <div>bin/<a
href="https://github.com/ramanan99/TestSnippets/blob/master/sha1_encryption/startnms.sh##L49">startnms.sh</a></div>
              <div>bin/<a
href="https://github.com/ramanan99/TestSnippets/blob/master/sha1_encryption/startApplicationClient.sh##L25">startApplicationClient.sh</a></div>
              <div><a
href="https://github.com/ramanan99/TestSnippets/blob/master/sha1_encryption/EncryptPassword.sh##L27">bin/admintools/EncryptPassword.sh</a><br>
              </div>
            </td>
            <td>
              <div>Add the following system properties along with other
                system properties while calling the main class:<span
                  class="Apple-converted-space">&nbsp;</span><br>
              </div>
              <div><font face="courier new, courier, monospace"
                  color="#0000ff" size="2">-DONEWAY_ENCRYPTION=<b>true</b>&nbsp;-DPASSWORD_ONEWAY_ENCRYPTION=com.adventnet.security.authentication.PasswordEncryptionImpl<br>
                </font>(The -<font face="courier new, courier,
                  monospace" color="#0000ff" size="2">DPASSWORD_ONEWAY_ENCRYPTION<span
                    class="Apple-converted-space">&nbsp;</span></font>is<span
                  class="Apple-converted-space">&nbsp;</span><i><u><b>NOT</b></u></i><span
                  class="Apple-converted-space">&nbsp;</span>mandatory
                if you choose to have the default encryption class. It
                can be changed if you need to change the encryption
                mechanism)<br>
                (Check the hyperlinked files as how to change these
                files)<br>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
    <div style="color: black; font-style: normal;
      font-variant-ligatures: normal; font-variant-caps: normal;
      font-weight: normal; letter-spacing: normal; line-height: normal;
      orphans: 2; text-align: start; text-indent: 0px; text-transform:
      none; white-space: normal; widows: 2; word-spacing: 0px;
      -webkit-text-stroke-width: 0px; font-size: medium; font-family:
      &quot;times new roman&quot;, times, serif;"><br>
      7. Start the server &amp; Login to client.</div>
    <div style="color: rgb(0, 0, 0); font-family: Verdana, Arial,
      Helvetica, sans-serif; font-size: 11px; font-style: normal;
      font-variant-ligatures: normal; font-variant-caps: normal;
      font-weight: normal; letter-spacing: normal; line-height: normal;
      orphans: 2; text-align: start; text-indent: 0px; text-transform:
      none; white-space: normal; widows: 2; word-spacing: 0px;
      -webkit-text-stroke-width: 0px;"><font style="color: black;
        font-size: medium;" face="times new roman, times, serif">While
        starting the server, check the following logs in the console:</font><br>
      <br>
    </div>
    <div style="color: black; font-style: normal;
      font-variant-ligatures: normal; font-variant-caps: normal;
      font-weight: normal; letter-spacing: normal; line-height: normal;
      orphans: 2; text-align: start; text-indent: 0px; text-transform:
      none; white-space: normal; widows: 2; word-spacing: 0px;
      -webkit-text-stroke-width: 0px; font-size: medium; font-family:
      &quot;times new roman&quot;, times, serif;">If you need to have
      the old encryption technique, then you need to remove the above 2
      system properties (<span style="font-size: small; color: rgb(0, 0,
        255); font-family: &quot;courier new&quot;, courier, monospace;">-DONEWAY_ENCRYPTION</span><span
        style="font-size: small; color: rgb(0, 0, 255); font-family:
        &quot;courier new&quot;, courier, monospace;">&nbsp;-DPASSWORD_ONEWAY_ENCRYPTION</span>)
      and revert the passwords in securitydbData.xml files and
      UserPasswordTable (<span style="font-family: &quot;times new
        roman&quot;, times, serif; font-size: medium;">If you had
        set&nbsp;<a
href="http://www.webnms.com/webnms/help/developer_guide/security_services/startup_options/security_fe.html#NMSAuthManager"><b>persist_data_in_xml</b></a>&nbsp;as
        false)</span></div>
    <div style="color: black; font-style: normal;
      font-variant-ligatures: normal; font-variant-caps: normal;
      font-weight: normal; letter-spacing: normal; line-height: normal;
      orphans: 2; text-align: start; text-indent: 0px; text-transform:
      none; white-space: normal; widows: 2; word-spacing: 0px;
      -webkit-text-stroke-width: 0px; font-size: medium; font-family:
      &quot;times new roman&quot;, times, serif;"><br>
    </div>
    <div style="color: black; font-style: normal;
      font-variant-ligatures: normal; font-variant-caps: normal;
      font-weight: normal; letter-spacing: normal; line-height: normal;
      orphans: 2; text-align: start; text-indent: 0px; text-transform:
      none; white-space: normal; widows: 2; word-spacing: 0px;
      -webkit-text-stroke-width: 0px; font-size: medium; font-family:
      &quot;times new roman&quot;, times, serif;">If you need any
      further clarification in this regard, please get back to us.<br>
      <br>
      Thanks &amp; regards<br>
      Venkatramanan<br>
    </div>
  </body>
</html>
