<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>

    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <title>3104658</title>
  </head>
  <body>
    <meta charset="utf-8">
    <div style="color: rgb(0, 0, 0); font-family: Verdana, Arial,
      Helvetica, sans-serif; font-size: 11px; font-style: normal;
      font-variant-ligatures: normal; font-variant-caps: normal;
      font-weight: normal; letter-spacing: normal; orphans: 2;
      text-align: start; text-indent: 0px; text-transform: none;
      white-space: normal; widows: 2; word-spacing: 0px;
      -webkit-text-stroke-width: 0px;"><font size="3" face="times new
        roman, times, serif">Dear Mike<br>
        <br>
        Thanks for the acknowledgment.<br>
        <br>
        Regards</font></div>
    <div style="color: rgb(0, 0, 0); font-family: Verdana, Arial,
      Helvetica, sans-serif; font-size: 11px; font-style: normal;
      font-variant-ligatures: normal; font-variant-caps: normal;
      font-weight: normal; letter-spacing: normal; orphans: 2;
      text-align: start; text-indent: 0px; text-transform: none;
      white-space: normal; widows: 2; word-spacing: 0px;
      -webkit-text-stroke-width: 0px;"><font size="3" face="times new
        roman, times, serif">Venkatramanan<br>
        <br>
      </font></div>
    <div style="color: rgb(0, 0, 0); font-family: Verdana, Arial,
      Helvetica, sans-serif; font-size: 11px; font-style: normal;
      font-variant-ligatures: normal; font-variant-caps: normal;
      font-weight: normal; letter-spacing: normal; orphans: 2;
      text-align: start; text-indent: 0px; text-transform: none;
      white-space: normal; widows: 2; word-spacing: 0px;
      -webkit-text-stroke-width: 0px;"><font size="3" face="times new
        roman, times, serif">&lt;Mike Fernacz&gt; wrote--------------</font></div>
    <div style="color: rgb(0, 0, 0); font-family: Verdana, Arial,
      Helvetica, sans-serif; font-size: 11px; font-style: normal;
      font-variant-ligatures: normal; font-variant-caps: normal;
      font-weight: normal; letter-spacing: normal; orphans: 2;
      text-align: start; text-indent: 0px; text-transform: none;
      white-space: normal; widows: 2; word-spacing: 0px;
      -webkit-text-stroke-width: 0px;"><font size="3" face="times new
        roman, times, serif">I got it working. The server was the wrong
        name.</font></div>
    <div style="color: rgb(0, 0, 0); font-family: Verdana, Arial,
      Helvetica, sans-serif; font-size: 11px; font-style: normal;
      font-variant-ligatures: normal; font-variant-caps: normal;
      font-weight: normal; letter-spacing: normal; orphans: 2;
      text-align: start; text-indent: 0px; text-transform: none;
      white-space: normal; widows: 2; word-spacing: 0px;
      -webkit-text-stroke-width: 0px;"><font size="3" face="times new
        roman, times, serif">Thanks,</font></div>
    <div style="color: rgb(0, 0, 0); font-family: Verdana, Arial,
      Helvetica, sans-serif; font-size: 11px; font-style: normal;
      font-variant-ligatures: normal; font-variant-caps: normal;
      font-weight: normal; letter-spacing: normal; orphans: 2;
      text-align: start; text-indent: 0px; text-transform: none;
      white-space: normal; widows: 2; word-spacing: 0px;
      -webkit-text-stroke-width: 0px;"><font size="3" face="times new
        roman, times, serif">Mike Fernacz &nbsp; &nbsp; &nbsp; &nbsp;
        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</font></div>
    <div style="color: rgb(0, 0, 0); font-family: Verdana, Arial,
      Helvetica, sans-serif; font-size: 11px; font-style: normal;
      font-variant-ligatures: normal; font-variant-caps: normal;
      font-weight: normal; letter-spacing: normal; orphans: 2;
      text-align: start; text-indent: 0px; text-transform: none;
      white-space: normal; widows: 2; word-spacing: 0px;
      -webkit-text-stroke-width: 0px;"><font size="3" face="times new
        roman, times, serif"><br>
      </font></div>
    <div style="color: rgb(0, 0, 0); font-family: Verdana, Arial,
      Helvetica, sans-serif; font-size: 11px; font-style: normal;
      font-variant-ligatures: normal; font-variant-caps: normal;
      font-weight: normal; letter-spacing: normal; orphans: 2;
      text-align: start; text-indent: 0px; text-transform: none;
      white-space: normal; widows: 2; word-spacing: 0px;
      -webkit-text-stroke-width: 0px;"><font size="3" face="times new
        roman, times, serif">From: nms-scp@zohocorp.com
        [mailto:nms-scp@zohocorp.com] On Behalf Of ZohoCorp WebNMS
        Support</font></div>
    <div style="color: rgb(0, 0, 0); font-family: Verdana, Arial,
      Helvetica, sans-serif; font-size: 11px; font-style: normal;
      font-variant-ligatures: normal; font-variant-caps: normal;
      font-weight: normal; letter-spacing: normal; orphans: 2;
      text-align: start; text-indent: 0px; text-transform: none;
      white-space: normal; widows: 2; word-spacing: 0px;
      -webkit-text-stroke-width: 0px;">
      <div style="font-family: Verdana, Arial, Helvetica, sans-serif;
        font-size: 11px;"><font size="3" face="times new roman, times,
          serif">Mike<br>
          <br>
          We believe that Java Mail package (Mail.jar, which we use to
          send mails) itself has some issues in sending mails in a
          secure manner.<br>
        </font><span style="font-family: &quot;times new roman&quot;,
          times, serif; font-size: medium;">We assume that you are
          running&nbsp;<i><b>WebNMS in SSL mode</b></i>. Below
          explanation is based on&nbsp;<b><i>the same assumption</i></b>.</span></div>
      <div style="font-family: Verdana, Arial, Helvetica, sans-serif;
        font-size: 11px;"><span style="font-family: &quot;times new
          roman&quot;, times, serif; font-size: medium;">Once you
          confirm the error after the same set of steps, then we can
          proceed from them.<br>
          <br>
        </span></div>
      <div style="font-family: Verdana, Arial, Helvetica, sans-serif;
        font-size: 11px;"><font size="3" face="times new roman, times,
          serif">Please follow the below steps to check with the same:<br>
        </font>
        <hr><font size="3" face="times new roman, times, serif">1.
          Download the attached files under NMS_HOME/classes.<br>
          <br>
          2. Encrypt your mail password with
          NMS_HOME/bin/admintools/EncryptPassword.bat as:&nbsp;</font><span
          style="font-family: &quot;courier new&quot;, courier,
          monospace; font-size: small;"><font color="#0000ff"><span
              style="background-color: rgb(254, 255, 102);">EncryptPassword.bat
              root public&nbsp;</span><b><span style="background-color:
                rgb(254, 255, 102);">&lt;mail_password&gt;</span>&nbsp;//"root
              public" is webnms credential</b></font></span><font
          size="3" face="times new roman, times, serif"><br>
          <br>
          3. Open&nbsp;<i><b>MySSLEMail.java</b></i>&nbsp;and configure
          the above password.<br>
          <br>
          4. Compile the MySSLEmail.java as</font><font size="2"
          color="#0000ff" face="courier new, courier, monospace">:<br>
          j</font><font style="color: rgb(0, 0, 255); font-family:
          &quot;courier new&quot;, courier, monospace; font-size:
          small;">avac -cp&nbsp;</font><span style="color: rgb(0, 0,
          255); font-family: &quot;courier new&quot;, courier,
          monospace; font-size: small;">%NMS_HOME%\classes\debugEmail.zip;</span><span
          style="color: rgb(0, 0, 255); font-family: &quot;courier
          new&quot;, courier, monospace; font-size: small;">%NMS_HOME%\classes\NmsServerClasses.jar;</span><span
          style="color: rgb(0, 0, 255); font-family: &quot;courier
          new&quot;, courier, monospace; font-size: small;">%NMS_HOME%\classes\Mail.jar</span><span
          style="color: rgb(0, 0, 255); font-family: &quot;courier
          new&quot;, courier, monospace; font-size: small;">&nbsp;-d .
          MySSLEMail.java</span></div>
      <div style="font-family: Verdana, Arial, Helvetica, sans-serif;
        font-size: 11px;"><font size="3" face="times new roman, times,
          serif"><br>
          5. Run the same file as:&nbsp;</font><font style="color:
          rgb(0, 0, 255); font-size: small; font-family: &quot;courier
          new&quot;, courier, monospace;">java -cp&nbsp;<b>.;</b></font><b><span
            style="color: rgb(0, 0, 255); font-size: small; font-family:
            &quot;courier new&quot;, courier, monospace;">debugEmail.zip;</span><span
            style="color: rgb(0, 0, 255); font-size: small; font-family:
            &quot;courier new&quot;, courier, monospace;">NmsServerClasses.jar;</span></b><font
          size="2" color="#0000ff" face="courier new, courier,
          monospace"><b>Mail.jar</b>&nbsp;-Djavax.net.ssl.trustStore=%NMS_HOME%/conf/Truststore.truststore&nbsp;<b>test.</b></font><span
          style="color: rgb(0, 0, 255); font-size: small; font-family:
          &quot;courier new&quot;, courier, monospace;"><b>MySSLEMail</b></span></div>
      <div style="font-family: Verdana, Arial, Helvetica, sans-serif;
        font-size: 11px;">
        <hr><font size="3" face="times new roman, times, serif">We
          believe the exception will be like:</font>
        <div><font size="2" color="#0000ff" face="courier new, courier,
            monospace"><span style="white-space: pre;">	</span>javax.net.ssl.SSLHandshakeException:
            sun.security.validator.ValidatorException: PKIX path
            building failed:
            sun.security.provider.certpath.SunCertPathBuilderException:
            unable to find valid certification path to requested target</font></div>
        <div><font size="2" color="#0000ff" face="courier new, courier,
            monospace"><span style="white-space: pre;">	</span>at
            javax.mail.Transport.send0(Transport.java:218)</font></div>
        <div><font size="2" color="#0000ff" face="courier new, courier,
            monospace"><span style="white-space: pre;">	</span>at
            javax.mail.Transport.send(Transport.java:80)</font></div>
        <div><font size="2" color="#0000ff" face="courier new, courier,
            monospace"><span style="white-space: pre;">	</span>at
            com.adventnet.nms.smtp.SmtpMailer.sendMessage(SmtpMailer.java:548)</font></div>
        <div><font size="2" color="#0000ff" face="courier new, courier,
            monospace"><span style="white-space: pre;">	</span>at
            test.MySSLEMail.main(MySSLEMail.java:33)</font></div>
      </div>
      <div style="font-family: Verdana, Arial, Helvetica, sans-serif;
        font-size: 11px;"><span style="font-family: &quot;times new
          roman&quot;, times, serif; font-size: medium;">If the
          exception is similar to the above, then we can progress from
          there.<br>
          <br>
          Thanks &amp; regards<br>
          Venkatramanan<br>
          <br>
          &lt;Mike Fernacz&gt; wrote--------------</span></div>
      <div style="font-family: Verdana, Arial, Helvetica, sans-serif;
        font-size: 11px;"><font size="3" face="times new roman, times,
          serif">Hi,</font></div>
      <div style="font-size: 12px; font-family: Verdana;"><font size="3"
          face="times new roman, times, serif">I am trying to setup an
          alert filter for email to office 365. It does not work. This
          is what I have configured. Our SMTP configuration require TLS
          and not SSL.</font></div>
      <div style="font-size: 12px; font-family: Verdana;"><font size="3"
          face="times new roman, times, serif"><br>
        </font></div>
      <div style="font-size: 12px; font-family: Verdana;"><font size="3"
          face="times new roman, times, serif">[cid:image001.png@01CE12E2.C126D6E0]</font></div>
      <div style="font-size: 12px; font-family: Verdana;"><font size="3"
          face="times new roman, times, serif">This is the error I get
          in the logs.</font></div>
      <div style="font-size: 12px; font-family: Verdana;"><font size="3"
          face="times new roman, times, serif">[24 Feb 2013
          22:53:58:302] SYS_OUT: Exception while sending mail
          notification. Sending failed;</font></div>
      <div style="font-size: 12px; font-family: Verdana;"><font size="3"
          face="times new roman, times, serif">nested exception is:</font></div>
      <div style="font-size: 12px; font-family: Verdana;"><font size="3"
          face="times new roman, times, serif">class
          javax.mail.MessagingException: 530 5.7.1 Client was not
          authenticated</font></div>
      <div style="font-size: 12px; font-family: Verdana;"><font size="3"
          face="times new roman, times, serif"><br>
        </font></div>
      <div style="font-size: 12px; font-family: Verdana;"><font size="3"
          face="times new roman, times, serif">Thanks,</font></div>
      <div style="font-size: 12px; font-family: Verdana;"><font size="3"
          face="times new roman, times, serif">Mike Fernacz</font></div>
    </div>
  </body>
</html>
